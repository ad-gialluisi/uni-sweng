<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Manuale d'installazione del Sistema Cicerone</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <style>
  li {
      margin-top: 10px;
      margin-bottom: 10px;
  }
  body {
  	font-size: 14pt;
  }
  </style>
</head>
<body>
<header id="title-block-header">
<h1 class="title">Manuale d'installazione del Sistema Cicerone</h1>
</header>
<h2
id="antonio-daniele-gialluisi-esame-di-ingegneria-del-software">Antonio
Daniele Gialluisi, esame di Ingegneria del software</h2>
<h3 id="indice">Indice</h3>
<ul>
<li><a href="#version">Versione sistema</a></li>
<li><a href="#info">Info sullo sviluppo</a></li>
<li><a href="#execenv_settings">Impostazione dell’ambiente
d’esecuzione</a></li>
<li><a href="#execenv_config">Configurazione dell’ambiente d’esecuzione
per il Sistema Cicerone</a></li>
<li><a href="#cicero_install">Installazione del sistema
Cicerone</a></li>
<li><a href="#debug_mode">Modalità DEBUG</a></li>
<li><a href="#android_testing">Testare il sistema da Android</a></li>
<li><a href="#utenti_test">Utenti di test</a></li>
</ul>
<hr />
<h3 id="version">
Versione del sistema
</h3>
<p>Questo manuale fa riferimento al sistema Cicerone v3.1 ERRATA CORRIGE
2</p>
<hr />
<h3 id="info">
Info sullo sviluppo
</h3>
<h4 id="ambiente-di-sviluppo-e-test">Ambiente di sviluppo e test</h4>
<ul>
<li>GNU/Linux Debian 10 con kernel vanilla 5.2.1, Eclipse IDE for PHP
v4.12, Apache 2.4, Maria DB 10.3.17, Firefox 70</li>
<li>Android 5.1, Firefox 66 (solo test)</li>
</ul>
<h4 id="librerie-esterne-utilizzate">Librerie esterne utilizzate</h4>
<ul>
<li>PHPMailer v6.1.1 per poter utilizzare server SMTP esterni per
effettuare la spedizione di email.</li>
</ul>
<p><em>NOTA</em>: Il sistema Cicerone necessita di Javascript e CSS
abilitati per funzionare correttamente.</p>
<hr />
<h3 id="execenv_settings">
Impostazione dell’ambiente d’esecuzione
</h3>
<p>Occorre installare i seguenti software:</p>
<ul>
<li>Webserver Apache v2.4 o superiore</li>
<li>DBMS MariaDB v10.3.18 o superiore (in alternativa MySQL Community
Edition v8.0 o superiore)</li>
<li>PHP v7.3 o superiore
<ul>
<li>Modulo PDO con driver MySQL</li>
<li>Modulo SSL</li>
<li>Modulo EXIF</li>
<li>Modulo JSON</li>
</ul></li>
</ul>
<p>È necessaria inoltre la disponibilità di un server SMTP esterno, come
ad esempio un account gmail o similari.</p>
<p><strong>Per gli utenti Windows</strong>, è raccomandato (ma non
obbligatorio) l’utilizzo di XAMPP v7.3.13 o superiore che installa
automaticamente componenti equivalenti a quelli citati poc’anzi.</p>
<p>Effettuate le installazioni, assicurarsi che siano abilitati nel file
di configurazione di PHP per il webserver Apache, i moduli PDO, driver
PDO per MySQL, OpenSSL, JSON ed EXIF.</p>
<p>Per assicurarsene, aprire il/i file di configurazione e verificare
che siano presenti le seguenti righe:</p>
<p>Su GNU/Linux:</p>
<pre><code>extension=pdo.so
extension=pdo_mysql.so
extension=openssl.so
extension=mbstring.so 
extension=exif.so
extension=json.so</code></pre>
<p><em>NOTA</em>: Molte distribuzioni GNU/Linux aggiungono in automatico
queste righe in altri file di configurazione (separati da quello
principale) al momento delle installazioni dei singoli moduli, quindi
non dovrebbe essere necessario questo passaggio.</p>
<p>Su Windows:</p>
<pre><code>extension=pdo.dll
extension=pdo_mysql.dll
extension=openssl.dll
extension=mbstring.dll
extension=exif.dll
extension=json.dll</code></pre>
<p><em>NOTA</em>: Assicurarsi che eventuali antivirus non blocchino le
connessioni SMTP in uscita, altrimenti l’invio di email non andrà a buon
fine.</p>
<p>Assicurarsi inoltre, che sia presente da qualche parte l’opzione:</p>
<pre><code>file_uploads = On</code></pre>
<p>altrimenti non sarà possibile effettuare l’upload delle immagini.</p>
<p><em>NOTA per chi usa MariaDB come DBMS</em>: è imperativo che il
character-set del server sia “utf8mb4”, questo è vero per le distro
GNU/Linux Debian-based, non è sempre vero in altri casi.<br />
Per impostare tale character set, è bene aggiungere le seguenti righe
nel file di configurazione (my.cnf su GNU/Linux, my.ini su Windows):</p>
<pre><code>[server]
character-set-server = &quot;utf8mb4&quot;</code></pre>
<p>per verificare che tutto sia andato bene, accedete al client a riga
di comando e digitate “status”, dovreste avere un risultato simile a
questo:</p>
<pre><code>..omesso..
Server characterset:    utf8mb4
Db     characterset:    utf8mb4
Client characterset:    utf8
Conn.  characterset:    utf8
..omesso..</code></pre>
<p>le righe importanti sono solo le prime due, non importa quali valori
abbiano le ultime due.</p>
<hr />
<h3 id="execenv_config">
Configurazione dell’ambiente d’esecuzione per il Sistema Cicerone
</h3>
<p>Modificate il file “cicero.conf” fornito, esso ha questo aspetto:</p>
<pre><code>&lt;VirtualHost *:80&gt;
    ServerName &lt;HOSTNAME_CICERONE&gt;
    ServerAdmin webmaster@localhost
    DocumentRoot &quot;&lt;PERCORSO_ASSOLUTO_SISTEMA_CICERONE&gt;&quot;

    &lt;Directory &quot;&lt;PERCORSO_ASSOLUTO_SISTEMA_CICERONE&gt;&quot;&gt;
        Options FollowSymLinks
        AllowOverride All
        Require all granted
    &lt;/Directory&gt;
&lt;/VirtualHost&gt;</code></pre>
<ul>
<li>Sostituite &lt;PERCORSO_ASSOLUTO_SISTEMA_CICERONE&gt; con un
percorso a vostra scelta dove risiederanno i file del sistema
Cicerone.</li>
<li>Sostituite &lt;HOSTNAME_CICERONE&gt; con un hostname a vostra scelta
(ad esempio: “cicero.com”) da utilizzare per collegarsi.</li>
</ul>
<p>Il risultato della vostra modifica impostatelo come file di
configurazione di Apache.<br />
È importante notare che in alcune installazioni (ad esempio XAMPP) è
necessario usare una direttiva “Include” all’interno del file di
configurazione principale, altrimenti il file che andrete a piazzare,
non verrà visto.<br />
Ricordarsi inoltre, di rendere noto al sistema operativo della presenza
dell’hostname modificando il file /etc/hosts (o
C:/Windows/System32/driver/etc/hosts su Windows) ed aggiungendo una riga
come questa:</p>
<pre><code>127.0.0.1 &lt;HOSTNAME_CICERONE&gt;</code></pre>
<p>Adesso, spostate i contenuti della cartella Cicerone in
&lt;PERCORSO_ASSOLUTO_SISTEMA_CICERONE&gt;.<br />
Se siete su GNU/Linux assicuratevi di spostare anche i file
nascosti.</p>
<p><em>NOTA</em>: Se si intende testare il sistema anche da Android, si
raccomanda in generale, di impostare &lt;HOSTNAME_CICERONE&gt; al valore
“localhost” (senza virgolette).<br />
Per vedere nel dettaglio come comportarsi, vedere la sezione <a
href="#android_testing">Testare il sistema da Android</a>.</p>
<p>Avviate dunque il servizio inerente il DBMS.</p>
<hr />
<h3 id="cicero_install">
Installazione del sistema Cicerone
</h3>
<h4 id="eseguire-lo-script-di-inizializzazione">Eseguire lo script di
inizializzazione</h4>
<p>Adesso spostatevi mediante terminale (o prompt dei comandi su
Windows), nella cartella &lt;PERCORSO_ASSOLUTO_SISTEMA_CICERONE&gt;
(questa deve essere la vostra cartella di lavoro, o working directory se
preferite).</p>
<p>Aprite con un editor di testo il file “inizializza.sh” (o
“inizializza.bat” se siete su Windows), verificate la correttezza delle
informazioni del DBMS MariaDB o MySQL e/o rendete/rimuovete commento su
alcune righe, se necessario, in base alle indicazioni del file.<br />
Se ad esempio ci si trova un sistema con SELinux, abilitare/disabilitate
le righe utili alla situazione affinchè non sussistano problemi.</p>
<p>Finite le modifiche, eseguite lo script perchè vengano creati i dati
persistenti e (su GNU/Linux) cambiati permessi e attributi dei
file.<br />
Su GNU/Linux lo script “inizializza.sh” necessita di essere eseguito
come root o utilizzando “sudo”.</p>
<h4 id="impostare-un-server-smtp">Impostare un server SMTP</h4>
<p><em>NOTA</em>: Per scongiurare invii accidentali di mail si è
provveduto ad impostare la modalità DEBUG così da avere più libertà di
testare, anche con indirizzi di posta fasulli.<br />
Se si intende utilizzare la funzionalità vera e propria, è necessario
prima disabilitare la modalità DEBUG (vedere sezione “Modalità
DEBUG”).</p>
<p>Andare e modificare il file utils/Spedizioniere.php per modificare i
dettagli di collegamento al server SMTP.<br />
Di default sono riportati i dettagli inerenti l’uso di un account gmail,
tuttavia, username e password sono impostati come stringa vuota.<br />
Cambiare opportunamente.</p>
<p><em>NOTA</em>: Gli utenti Google che usano l’autenticazione a due
fattori devono creare una password per app sul proprio account ed
utilizzare questa come password per lo Spedizioniere.</p>
<p>Ora è possibile avviare anche il servizio inerente Apache ed iniziare
ad utilizzare il sistema Cicerone.</p>
<h4 id="ulteriori-note-per-utenti-gnulinux">Ulteriori note per utenti
GNU/Linux</h4>
<ul>
<li><p>Alcuni pacchetti per i moduli/estensioni di PHP sono nominati
diversamente tra le diverse distribuzioni, ad esempio, per installare il
modulo PDO per MySQL su Debian 10, è sufficiente installare il pacchetto
php-pdo-mysql, ma su Fedora 29 sono necessari i pacchetti php-pdo_mysql,
php-mysqlnd.<br />
Innanzitutto suggerisco di abilitare, se non già abilitato, il mostrare
gli errori direttamente sul browser cosicchè, possiate capire se ci sono
problemi e di quale natura.<br />
Se qualcosa non funziona come dovrebbe, ad esempio, alcune funzioni non
sono definite o questioni simili, assicurarsi che si siano installati i
pacchetti in base alla distribuzione in utilizzo.<br />
Per mostrare gli errori su schermo, assicurarsi che il file di
configurazione principale di PHP abbia, da qualche parte, le seguenti
righe:</p>
<pre><code>display_errors = On
display_startup_errors = On</code></pre></li>
<li><p>Su Fedora viene installato di default un programma
Firewall.<br />
Tale programma considera come non fidati i servizi locali di http e
https, è necessario andare nella propria configurazione ed impostarli
come fidati perchè si possa usare il sistema Cicerone.</p></li>
<li><p>Lo script “inizializza.sh” viene eseguito:</p>
<ul>
<li>Per cambiare i permessi e contesti a file e cartelle</li>
<li>Per impostare i dati persistenti e l’utente interno del
Database.</li>
</ul></li>
</ul>
<hr />
<h3 id="debug_mode">
Modalità DEBUG
</h3>
<p>Se per un qualche motivo si intende utilizzare la modalità DEBUG del
sistema, è necessario modificare i seguenti file:</p>
<ul>
<li><p>utils/Spedizioniere.php, se si intende disabilitare l’invio di
email e sostituirlo con la scrittura delle stesse su un file.<br />
Cercare la proprietà “DEBUG” ed impostarla a “true”.<br />
Le email verranno scritte (sovrascrivendosi di volta in volta) nella
cartella debug/rwdir.</p></li>
<li><p>vista/Vista.php, se si intende fare debug del sistema Cicerone e
di tutte le sue funzionalità.<br />
Cercare la proprietà “DEBUG” ed impostarla a “true”.<br />
Quando la modalità DEBUG è abilitata, utilizzare CTRL-D sul browser per
vedere il menù DebugSettings, utile per fare test arbitrari.<br />
<em>NOTA</em>: tra le capacità, c’è l’abilitazione della modalità debug
di XDebug tramite parametri GET “XDEBUG_SESSION_START” e “KEY”.<br />
Se necessario, andare in debug/DebugSettings.php ed impostare dei
diversi valori a questi parametri, poichè sono impostati quelli di
default dell’IDE Eclipse.</p></li>
<li><p>vista/Layout.php, se si intende effettuare un dump (cioè uno
scaricamento totale e grezzo) delle schermate generate dal sistema
Cicerone su un file, oltre che mostrarle sul browser.<br />
Cercare la proprietà “DEBUG” ed impostarla a “true”.<br />
Le schermate verranno salvate (sovrascrivendosi di volta in volta) nella
cartella debug/rwdir.</p></li>
</ul>
<p>Di default, questo pacchetto viene distribuito con tutti i valori ad
eccezione di Layout::DEBUG (il dump delle schermate), impostati su
“true”.<br />
In particolare, si è scelto di abilitare Spedizioniere.php::DEBUG in
maniera tale da non far partire l’invio di email, a meno che non si
voglia ESPLICITAMENTE testare tale funzionalità.<br />
Può essere utile ad esempio, se non si ha a disposizione un server SMTP
e si vuole testare comunque, oppure, se non si intende utilizzare un
proprio account solo per questo scopo.</p>
<hr />
<h3 id="android_testing">
Testare il sistema da Android
</h3>
<p>È possibile usare due metodi:</p>
<ol type="1">
<li>Collegarsi da Android ad una rete locale per accedere al webserver
del PC (solitamente richiede il port forwarding di un router).</li>
<li>Mediante Android Debug Bridge (adb), con l’uso del reverse port
forwarding (ovvero la mappatura di una porta del PC ad una del
dispositivo portatile bersaglio).</li>
</ol>
<p>È da notare come anche in Android sia necessario aggiungere
&lt;HOSTNAME_CICERONE&gt; al file /etc/hosts affinchè ci si possa
collegare al sistema Cicerone.<br />
Se non si dispone di un dispositivo con i permessi di root però, questo
non è possibile, perchè /etc/hosts è in sola lettura.<br />
Se questa è la situazione, raccomando l’uso dell’hostname “localhost”,
dato che di solito è quello di default.<br />
Per andare sul sicuro, usate un’App “Emulatore di Terminale” (o mediante
Android Debug Bridge shell) e digitate:</p>
<pre><code>cat /etc/hosts</code></pre>
<p>per vedere dunque, quali sono gli hostname a cui è associato
127.0.0.1 e impostate &lt;HOSTNAME_CICERONE&gt; di conseguenza.<br />
Se al contrario avete un dispositivo con permessi di root, semplicemente
aggiungete &lt;HOSTNAME_CICERONE&gt; al file /etc/hosts come già
indicato nella sezione <a href="#execenv_config">Configurazione
dell’ambiente d’esecuzione per il Sistema Cicerone</a>.</p>
<p>Essendo più semplice, spiegherò come fare il reverse port forwarding,
però per farlo occorre installare Android Debug Bridge, ed in seguito,
abilitare le opzioni da sviluppatore e il Debug USB sul
dispositivo.<br />
Assumerò che sia tutto installato e che il dispositivo sia
INDIVIDUABILE.</p>
<p>Collegate il dispositivo al PC e digitate da terminale il seguente
comando:</p>
<pre><code>adb reverse tcp:&lt;PORTA&gt; tcp:80</code></pre>
<p>&lt;PORTA&gt; può essere una porta qualunque del dispositivo.</p>
<p>Ora, usando il dispositivo, aprire un browser ed inserire nella barra
degli indirizzi:</p>
<pre><code>http://&lt;HOSTNAME_CICERONE&gt;:&lt;PORTA&gt;</code></pre>
<hr />
<h3 id="utenti_test">
Utenti di test
</h3>
<p>È necessario sapere che sono stati forniti degli utenti di test per
usare IMMEDIATAMENTE il sistema.<br />
Ovviamente è possibile creare nuovi utenti facilmente, tuttavia, se si
vuol fare un utilizzo di prova veloce, è possibile.<br />
</p>
<ul>
<li>nomeutente: antoniodaniele, password: antoniodaniele
(Amministratore)</li>
<li>nomeutente: caligola, password: caligola (Cicerone)</li>
<li>nomeutente: giuliocesare, password: giuliocesare
(QuasiCicerone)</li>
<li>nomeutente: neroneclaudio, password: neroneclaudio
(Globetrotter)</li>
</ul>
</body>
</html>
